



### 什么是可重入锁，以及它的作用是什么？

资料来源：[什么是可重入锁，以及它的作用是什么？](https://www.toutiao.com/video/7091103367166067231/)

可重入是多线程并发编程里面一个比较重要的概念，<br/>
简单来说， 就是在运行的某个函数或者代码， 因为抢占资源或者中断等原因导致函数或者代码的运行中断，<br/>
等待中断程序执行结束后， 重新进入到这个函数或者代码中运行， 并且运行结果不会受到影响， 那么这个函数或者代码就是可重入的。<br/>
而可重入锁， 简单来说就是一个线程如果抢占到了互斥锁资源， 在锁释放之前再去竞争同一把锁的时候， 不需要等待， 只需要记录重入次数。<br/>
在多线程并发编程里面， 绝大部分锁都是可重入的， 比如 Synchronized、ReentrantLock 等， 但是也有不支持重入的锁， 比如 JDK8 里面提供的读写锁
StampedLock。 <br/>

![image-20221008143249237](img/image-20221008143249237.png ':size=40%')<br/>

锁的可重入性， 主要解决的问题是避免线程死锁的问题。<br/>
因为一个已经获得同步锁 X 的线程， 在释放锁 X 之前再去竞争锁 X 的时候， 相当于会出现自己要等待自己释放锁， 这很显然是无法成立的。<br/>
以上就是我对这个问题的理解。

<hr>



### 分布式锁的理解和实现

资料来源：[分布式锁的理解和实现](https://www.toutiao.com/video/7081573477920014878/?from_scene=all)

分布式锁， 是一种跨进程的跨机器节点的互斥锁， 它可以用来保证多机器节点对于共享资源访问的排他性

![image-20221008143503512](img/image-20221008143503512.png ':size=40%')<br/>

<hr>

### 关于Synchronized锁升级的原理

资料来源：[关于Synchronized锁升级的原理](https://www.toutiao.com/video/7098884844192694815/)

**  todo **
<hr>

### ReentrantLock是如何实现锁公平和非公平性的

资料来源：[ReentrantLock是如何实现锁公平和非公平性的](https://www.toutiao.com/video/7103772817413374500/?from_scene=all)

#### 回答：

我先解释一下个公平和非公平的概念。
公平， 指的是竞争锁资源的线程， 严格按照请求顺序来分配锁。
非公平， 表示竞争锁资源的线程， 允许插队来抢占锁资源。
ReentrantLock 默认采用了非公平锁的策略来实现锁的竞争逻辑。
其次， ReentrantLock 内部使用了 AQS 来实现锁资源的竞争，  

没有竞争到锁资源的线程， 会加入到 AQS 的同步队列里面， 这个队列是一个FIFO 的双向链表。  

![image-20221005164300424](img/image-20221005164300424.png  ':size=60%')

在这样的一个背景下， 公平锁的实现方式就是， 线程在竞争锁资源的时候判断AQS 同步队列里面有没有等待的线程。
如果有， 就加入到队列的尾部等待。
而非公平锁的实现方式， 就是不管队列里面有没有线程等待， 它都会先去尝试抢占锁资源， 如果抢不到， 再加入到 AQS 同步队列等待。
ReentrantLock 和 Synchronized 默认都是非公平锁的策略， 之所以要这么设计，
我认为还是考虑到了性能这个方面的原因。
因为一个竞争锁的线程如果按照公平的策略去阻塞等待， 同时 AQS 再把等待队列里面的线程唤醒， 这里会涉及到内核态的切换， 对性能的影响比较大。
如果是非公平策略， 当前线程正好在上一个线程释放锁的临界点抢占到了锁， 就意味着这个线程不需要切换到内核态， 虽然对原本应该要被唤醒的线程不公平，
但是提升了锁竞争的性能。
以上就是我对这个问题的理解。  
<hr>



### 如何在不加锁的情况下解决线程安全问题

资料来源：[如何在不加锁的情况下解决线程安全问题](https://www.toutiao.com/video/7037400683049386509/)

<hr>

### 实现分布式锁的解决方案中，你认为Zookeeper和Redis哪种更好？

资料来源：[实现分布式锁的解决方案中，你认为Zookeeper和Redis哪种更好？](https://www.toutiao.com/video/7032604058363888135/)

**  todo **
<hr>

### 什么是死锁？

资料来源：[什么是死锁？](https://www.toutiao.com/video/7024820470994174504/)


